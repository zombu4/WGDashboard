import{D as R,a as V}from"./dashboardSettingsWireguardConfigurationAutostart-wxnOY_IS.js";import{L as u}from"./localeText-DUwuOj1w.js";import{r as m,I as B,o as L,g as D,D as O,c as o,f as s,a,t as k,q as P,v as S,d as H,e as d,b as l,n as b,B as E,W,F as A,k as M,l as U,u as j,E as F}from"./index-2yZR85cE.js";const Y={class:"card"},q={class:"card-header"},G={class:"card-body"},J={class:"row gy-2"},K={class:"col-sm"},Q={class:"form-check form-switch"},X=["disabled","id"],Z=["for"],ee={class:"d-flex align-items-start align-items-md-center flex-column flex-md-row gap-2"},ae={class:"mb-0"},te={class:"text-muted fw-normal"},ne={key:0,class:"ms-md-auto d-flex gap-2"},ie={key:1,class:"ms-md-auto d-flex gap-2 align-items-center"},se={class:"col-sm"},oe={class:"form-check form-switch"},le=["disabled","id"],re=["for"],de={class:"d-flex align-items-start align-items-md-center flex-column flex-md-row gap-2"},ce={key:0,class:"placeholder animate__animated animate__flash animate__infinite animate__slower w-100 mb-0"},ue={key:1,class:"mb-0"},fe={class:"text-muted fw-normal"},ge={key:0,class:"ms-md-auto d-flex gap-2"},me={key:1,class:"ms-md-auto d-flex gap-2 align-items-center"},be={__name:"configurationTracking",props:["configuration"],async setup(n){let T,p;const c=n,v=m({HistoricalTrackingTableSize:0,TrafficTrackingTableSize:0}),w=m(!1),x=m(!1);[T,p]=B(async()=>L(async()=>{await y()})),await T,p();const y=async()=>{w.value=!1,await D("/api/getPeerTrackingTableCounts",{configurationName:c.configuration.Name},i=>{v.value=i.data,w.value=!0})},_=async i=>{x.value=!0,await E("/api/updateWireguardConfigurationInfo",{Name:c.configuration.Name,Key:i,Value:c.configuration.Info[i]},e=>{console.log(e),x.value=!1})},f=m(void 0),C=async i=>{f.value=i,await D("/api/downloadPeerTrackingTable",{configurationName:c.configuration.Name,table:i},e=>{if(e.status){const t=JSON.stringify(e.data,null,2),I=new Blob([t],{type:"application/json"}),z=URL.createObjectURL(I),h=document.createElement("a");h.href=z,h.download=`${c.configuration.Name}_${i}.json`,h.click(),f.value=void 0}})},r=m(""),g=m(void 0),N=O(),$=async i=>{g.value=!0,await E("/api/deletePeerTrackingTable",{configurationName:c.configuration.Name,table:i},async e=>{e.status?N.newMessage("Server","Record deleted","success"):N.newMessage("Server","Record delete failed","danger"),await y(),g.value=!1,r.value=""})};return(i,e)=>(s(),o("div",Y,[a("div",q,k(n.configuration.Name),1),a("div",G,[a("div",J,[a("div",K,[e[16]||(e[16]=a("small",{class:"text-muted fw-bold"},"Peer Traffic Tracking",-1)),a("div",Q,[P(a("input",{class:"form-check-input",type:"checkbox",disabled:x.value,onChange:e[0]||(e[0]=t=>_("PeerTrafficTracking")),"onUpdate:modelValue":e[1]||(e[1]=t=>n.configuration.Info.PeerTrafficTracking=t),id:n.configuration.Name+"_traffic_tracking"},null,40,X),[[S,n.configuration.Info.PeerTrafficTracking]]),a("label",{class:"form-check-label",for:n.configuration.Name+"_traffic_tracking"},k(n.configuration.Info.PeerTrafficTracking?"On":"Off"),9,Z)]),e[17]||(e[17]=a("hr",null,null,-1)),a("div",ee,[a("h6",ae,[d(k(v.value.TrafficTrackingTableSize)+" ",1),a("span",te,[l(u,{t:"Records"})])]),r.value!=="TrafficTrackingTable"?(s(),o("div",ne,[a("button",{class:b(["btn btn-sm bg-primary-subtle text-primary-emphasis rounded-3",{disabled:f.value==="TrafficTrackingTable"}]),onClick:e[2]||(e[2]=t=>C("TrafficTrackingTable"))},[e[12]||(e[12]=a("i",{class:"bi bi-download me-2"},null,-1)),l(u,{t:f.value==="TrafficTrackingTable"?"Downloading...":"Download"},null,8,["t"])],2),a("button",{class:"btn btn-sm bg-danger-subtle text-danger-emphasis rounded-3",onClick:e[3]||(e[3]=t=>r.value="TrafficTrackingTable")},[...e[13]||(e[13]=[a("i",{class:"bi bi-trash me-2"},null,-1),d("Delete ",-1)])])])):r.value==="TrafficTrackingTable"?(s(),o("div",ie,[a("small",null,[l(u,{t:"Are you sure to delete?"})]),a("button",{class:b(["btn btn-sm bg-danger-subtle text-danger-emphasis rounded-3",{disabled:g.value}]),onClick:e[4]||(e[4]=t=>$("TrafficTrackingTable"))},[...e[14]||(e[14]=[a("i",{class:"bi bi-check me-2"},null,-1),d("Yes ",-1)])],2),a("button",{class:b([{disabled:g.value},"btn btn-sm bg-secondary-subtle text-secondary-emphasis rounded-3"]),onClick:e[5]||(e[5]=t=>r.value="")},[...e[15]||(e[15]=[a("i",{class:"bi bi-x me-2"},null,-1),d("No ",-1)])],2)])):H("",!0)])]),a("div",se,[e[22]||(e[22]=a("small",{class:"text-muted fw-bold"},"Peer Historical Endpoint Tracking",-1)),a("div",oe,[P(a("input",{class:"form-check-input",disabled:x.value,onChange:e[6]||(e[6]=t=>_("PeerHistoricalEndpointTracking")),type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=t=>n.configuration.Info.PeerHistoricalEndpointTracking=t),id:n.configuration.Name+"_historicalEndpoint_tracking"},null,40,le),[[S,n.configuration.Info.PeerHistoricalEndpointTracking]]),a("label",{class:"form-check-label",for:n.configuration.Name+"_historicalEndpoint_tracking"},k(n.configuration.Info.PeerHistoricalEndpointTracking?"On":"Off"),9,re)]),e[23]||(e[23]=a("hr",null,null,-1)),a("div",de,[a("div",null,[w.value?(s(),o("h6",ue,[d(k(v.value.HistoricalTrackingTableSize)+" ",1),a("span",fe,[l(u,{t:"Records"})])])):(s(),o("h6",ce))]),r.value!=="HistoricalTrackingTable"?(s(),o("div",ge,[a("button",{onClick:e[8]||(e[8]=t=>C("HistoricalTrackingTable")),class:b([{disabled:f.value==="HistoricalTrackingTable"},"btn btn-sm bg-primary-subtle text-primary-emphasis rounded-3"])},[e[18]||(e[18]=a("i",{class:"bi bi-download me-2"},null,-1)),l(u,{t:f.value==="HistoricalTrackingTable"?"Downloading...":"Download"},null,8,["t"])],2),a("button",{class:"btn btn-sm bg-danger-subtle text-danger-emphasis rounded-3",onClick:e[9]||(e[9]=t=>r.value="HistoricalTrackingTable")},[...e[19]||(e[19]=[a("i",{class:"bi bi-trash me-2"},null,-1),d("Delete ",-1)])])])):r.value==="HistoricalTrackingTable"?(s(),o("div",me,[a("small",null,[l(u,{t:"Are you sure to delete?"})]),a("button",{class:b(["btn btn-sm bg-danger-subtle text-danger-emphasis rounded-3",{disabled:g.value}]),onClick:e[10]||(e[10]=t=>$("HistoricalTrackingTable"))},[...e[20]||(e[20]=[a("i",{class:"bi bi-check me-2"},null,-1),d("Yes ",-1)])],2),a("button",{class:b([{disabled:g.value},"btn btn-sm bg-secondary-subtle text-secondary-emphasis rounded-3"]),onClick:e[11]||(e[11]=t=>r.value="")},[...e[21]||(e[21]=[a("i",{class:"bi bi-x me-2"},null,-1),d("No ",-1)])],2)])):H("",!0)])])])])]))}},Te={class:"card"},ve={class:"card-header"},ke={class:"my-2"},pe={class:"card-body d-flex flex-column gap-3"},xe={__name:"dashboardWireguardConfigurationTracking",setup(n){const T=W();return(p,c)=>(s(),o("div",Te,[a("div",ve,[a("h6",ke,[l(u,{t:"Peer Tracking"})])]),a("div",pe,[(s(!0),o(A,null,M(j(T).Configurations,v=>(s(),U(be,{configuration:v},null,8,["configuration"]))),256))])]))}},we={class:"d-flex gap-3 flex-column"},Ce=F({__name:"wireguardConfigurationSettings",setup(n){return(T,p)=>(s(),o("div",we,[l(R,{targetData:"wg_conf_path",title:"Configurations Directory",warning:!0,"warning-text":"Remember to remove / at the end of your path. e.g /etc/wireguard"}),l(V),l(xe)]))}});export{Ce as default};
