import{_ as A,c as r,a as e,q as h,b as l,j as y,A as v,n as k,t as x,B as w,D as $,C as S,f as i,d as g,h as F,i as M,v as D,e as P,l as _,F as K,w as V,T as N,m as U,g as T,k as E,o as Y,r as I,u as m,H}from"./index-Cf4jNNie.js";import{L as c}from"./localeText-BilYarrN.js";import{d as C}from"./dayjs.min-zFrFwdFG.js";import{Z as R}from"./vue-datepicker-Dv9kEeGY.js";const q={name:"accountSettingsInputUsername",components:{LocaleText:c},props:{targetData:String,title:String},setup(){const t=$(),s=`input_${S()}`;return{store:t,uuid:s}},data(){return{value:"",invalidFeedback:"",showInvalidFeedback:!1,isValid:!1,timeout:void 0,changed:!1,updating:!1}},mounted(){this.value=this.store.Configuration.Account[this.targetData]},methods:{async useValidation(t){this.changed&&(this.updating=!0,await w("/api/updateDashboardConfigurationItem",{section:"Account",key:this.targetData,value:this.value},s=>{s.status?(this.isValid=!0,this.showInvalidFeedback=!1,this.store.Configuration.Account[this.targetData]=this.value,clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.isValid=!1,5e3)):(this.isValid=!1,this.showInvalidFeedback=!0,this.invalidFeedback=s.message),this.changed=!1,this.updating=!1}))}}},B={class:"form-group mb-2"},j=["for"],z=["id","disabled"],W={class:"invalid-feedback"};function G(t,s,b,f,u,p){const o=y("LocaleText");return i(),r("div",B,[e("label",{for:this.uuid,class:"text-muted mb-1"},[e("strong",null,[e("small",null,[l(o,{t:this.title},null,8,["t"])])])],8,j),h(e("input",{type:"text",class:k(["form-control",{"is-invalid":u.showInvalidFeedback,"is-valid":u.isValid}]),id:this.uuid,"onUpdate:modelValue":s[0]||(s[0]=a=>this.value=a),onKeydown:s[1]||(s[1]=a=>this.changed=!0),onBlur:s[2]||(s[2]=a=>p.useValidation()),disabled:this.updating},null,42,z),[[v,this.value]]),e("div",W,x(this.invalidFeedback),1)])}const vt=A(q,[["render",G]]),O={name:"accountSettingsInputPassword",components:{LocaleText:c},props:{targetData:String,warning:!1,warningText:""},setup(){const t=$(),s=`input_${S()}`;return{store:t,uuid:s}},data(){return{value:{currentPassword:"",newPassword:"",repeatNewPassword:""},invalidFeedback:"",showInvalidFeedback:!1,isValid:!1,timeout:void 0}},methods:{async useValidation(){Object.values(this.value).find(t=>t.length===0)===void 0?this.value.newPassword===this.value.repeatNewPassword?await w("/api/updateDashboardConfigurationItem",{section:"Account",key:this.targetData,value:this.value},t=>{t.status?(this.isValid=!0,this.showInvalidFeedback=!1,this.store.Configuration.Account[this.targetData]=this.value,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.isValid=!1,this.value={currentPassword:"",newPassword:"",repeatNewPassword:""}},5e3)):(this.isValid=!1,this.showInvalidFeedback=!0,this.invalidFeedback=t.message)}):(this.showInvalidFeedback=!0,this.invalidFeedback="New passwords does not match"):(this.showInvalidFeedback=!0,this.invalidFeedback="Please fill in all required fields.")}},computed:{passwordValid(){return Object.values(this.value).find(t=>t.length===0)===void 0&&this.value.newPassword===this.value.repeatNewPassword}}},Z={class:"d-flex flex-column gap-2"},J={class:"row g-2"},Q={class:"col-sm"},X={class:"form-group"},ee=["for"],se=["id"],te={key:0,class:"invalid-feedback d-block"},ae={class:"col-sm"},ie={class:"form-group"},oe=["for"],ne=["id"],le={class:"col-sm"},de={class:"form-group"},re=["for"],ue=["id"],ce=["disabled"];function me(t,s,b,f,u,p){const o=y("LocaleText");return i(),r("div",null,[e("h6",null,[l(o,{t:"Update Password"})]),e("form",Z,[e("div",J,[e("div",Q,[e("div",X,[e("label",{for:"currentPassword_"+this.uuid,class:"text-muted mb-1"},[e("strong",null,[e("small",null,[l(o,{t:"Current Password"})])])],8,ee),h(e("input",{type:"password",class:k(["form-control",{"is-invalid":u.showInvalidFeedback,"is-valid":u.isValid}]),autocomplete:"current-password","onUpdate:modelValue":s[0]||(s[0]=a=>this.value.currentPassword=a),id:"currentPassword_"+this.uuid},null,10,se),[[v,this.value.currentPassword]]),u.showInvalidFeedback?(i(),r("div",te,x(this.invalidFeedback),1)):g("",!0)])]),e("div",ae,[e("div",ie,[e("label",{for:"newPassword_"+this.uuid,class:"text-muted mb-1"},[e("strong",null,[e("small",null,[l(o,{t:"New Password"})])])],8,oe),h(e("input",{type:"password",class:k(["form-control",{"is-invalid":u.showInvalidFeedback,"is-valid":u.isValid}]),autocomplete:"new-password","onUpdate:modelValue":s[1]||(s[1]=a=>this.value.newPassword=a),id:"newPassword_"+this.uuid},null,10,ne),[[v,this.value.newPassword]])])]),e("div",le,[e("div",de,[e("label",{for:"repeatNewPassword_"+this.uuid,class:"text-muted mb-1"},[e("strong",null,[e("small",null,[l(o,{t:"Repeat New Password"})])])],8,re),h(e("input",{type:"password",class:k(["form-control",{"is-invalid":u.showInvalidFeedback,"is-valid":u.isValid}]),autocomplete:"new-password","onUpdate:modelValue":s[2]||(s[2]=a=>this.value.repeatNewPassword=a),id:"repeatNewPassword_"+this.uuid},null,10,ue),[[v,this.value.repeatNewPassword]])])])]),e("button",{disabled:!this.passwordValid,class:"ms-auto btn bg-success-subtle text-success-emphasis border-1 border-success-subtle rounded-3 shadow-sm",onClick:s[3]||(s[3]=a=>this.useValidation())},[s[4]||(s[4]=e("i",{class:"bi bi-save2-fill me-2"},null,-1)),l(o,{t:"Save"})],8,ce)])])}const _t=A(O,[["render",me]]),he={name:"dashboardTheme",components:{LocaleText:c},setup(){return{dashboardConfigurationStore:$()}},methods:{async switchTheme(t){await w("/api/updateDashboardConfigurationItem",{section:"Server",key:"dashboard_theme",value:t},s=>{s.status&&(this.dashboardConfigurationStore.Configuration.Server.dashboard_theme=t)})}}},pe={class:"text-muted mb-1 d-block"},be={class:"d-flex gap-1"};function fe(t,s,b,f,u,p){const o=y("LocaleText");return i(),r("div",null,[e("small",pe,[e("strong",null,[l(o,{t:"Theme"})])]),e("div",be,[e("button",{class:k(["btn bg-primary-subtle text-primary-emphasis flex-grow-1",{active:this.dashboardConfigurationStore.Configuration.Server.dashboard_theme==="system"}]),onClick:s[0]||(s[0]=a=>this.switchTheme("system"))},[s[3]||(s[3]=e("i",{class:"bi bi-circle-half me-2"},null,-1)),l(o,{t:"System"})],2),e("button",{class:k(["btn bg-primary-subtle text-primary-emphasis flex-grow-1",{active:this.dashboardConfigurationStore.Configuration.Server.dashboard_theme==="light"}]),onClick:s[1]||(s[1]=a=>this.switchTheme("light"))},[s[4]||(s[4]=e("i",{class:"bi bi-sun-fill me-2"},null,-1)),l(o,{t:"Light"})],2),e("button",{class:k(["btn bg-primary-subtle text-primary-emphasis flex-grow-1",{active:this.dashboardConfigurationStore.Configuration.Server.dashboard_theme==="dark"}]),onClick:s[2]||(s[2]=a=>this.switchTheme("dark"))},[s[5]||(s[5]=e("i",{class:"bi bi-moon-fill me-2"},null,-1)),l(o,{t:"Dark"})],2)])])}const yt=A(he,[["render",fe]]),ge={name:"newDashboardAPIKey",components:{LocaleText:c,VueDatePicker:R},data(){return{newKeyData:{ExpiredAt:C().add(7,"d").format("YYYY-MM-DD HH:mm:ss"),NeverExpire:!1},submitting:!1}},setup(){return{store:$()}},mounted(){M(),console.log(this.newKeyData.ExpiredAt)},computed:{isDark(){return F(this.store.Configuration.Server.dashboard_theme)==="dark"}},methods:{submitNewAPIKey(){this.submitting=!0,w("/api/newDashboardAPIKey",this.newKeyData,t=>{t.status?(this.$emit("created",t.data),this.store.newMessage("Server","API Key created","success"),this.$emit("close")):this.store.newMessage("Server",t.message,"danger"),this.submitting=!1})},fixDate(t){return console.log(C(t).format("YYYY-MM-DDTHH:mm:ss")),C(t).format("YYYY-MM-DDTHH:mm:ss")},parseTime(t){t?this.newKeyData.ExpiredAt=C(t).format("YYYY-MM-DD HH:mm:ss"):this.newKeyData.ExpiredAt=void 0}}},ve={class:"position-absolute w-100 h-100 top-0 start-0 rounded-bottom-3 p-3 d-flex",style:{"background-color":"#00000060","backdrop-filter":"blur(3px)","z-index":"9999"}},_e={class:"card m-auto rounded-3 mt-5"},ye={class:"card-header bg-transparent d-flex align-items-center gap-2 border-0 p-4 pb-0"},we={class:"mb-0"},ke={class:"card-body d-flex gap-2 p-4 flex-column"},$e={class:"text-muted"},xe={class:"d-flex align-items-center gap-2"},Ae={class:"form-check"},Ce=["disabled"],Pe={class:"form-check-label",for:"neverExpire"},De={key:0,class:"bi bi-check-lg me-2"};function Ie(t,s,b,f,u,p){const o=y("LocaleText"),a=y("VueDatePicker");return i(),r("div",ve,[e("div",_e,[e("div",ye,[e("h6",we,[l(o,{t:"Create API Key"})]),e("button",{type:"button",class:"btn-close ms-auto",onClick:s[0]||(s[0]=n=>this.$emit("close"))})]),e("div",ke,[e("small",$e,[l(o,{t:"When should this API Key expire?"})]),e("div",xe,[l(a,{style:{"z-index":"9999"},is24:!0,"min-date":new Date,"model-value":this.newKeyData.ExpiredAt,"onUpdate:modelValue":this.parseTime,"time-picker-inline":"",format:"yyyy-MM-dd HH:mm:ss","preview-format":"yyyy-MM-dd HH:mm:ss",clearable:!1,disabled:this.newKeyData.NeverExpire||this.submitting,dark:p.isDark},null,8,["min-date","model-value","onUpdate:modelValue","disabled","dark"])]),e("div",Ae,[h(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[1]||(s[1]=n=>this.newKeyData.NeverExpire=n),id:"neverExpire",disabled:this.submitting},null,8,Ce),[[D,this.newKeyData.NeverExpire]]),e("label",Pe,[l(o,{t:"Never Expire"}),s[3]||(s[3]=P(" (",-1)),s[4]||(s[4]=e("i",{class:"bi bi-emoji-grimace-fill me-2"},null,-1)),l(o,{t:"Don't think that's a good idea"}),s[5]||(s[5]=P(") ",-1))])]),e("button",{class:k(["ms-auto btn bg-success-subtle text-success-emphasis border-1 border-success-subtle rounded-3 shadow-sm",{disabled:this.submitting}]),onClick:s[2]||(s[2]=n=>this.submitNewAPIKey())},[this.submitting?g("",!0):(i(),r("i",De)),this.submitting?(i(),_(o,{key:1,t:"Creating..."})):(i(),_(o,{key:2,t:"Create"}))],2)])])])}const Se=A(ge,[["render",Ie]]),Ke={name:"dashboardAPIKey",components:{LocaleText:c},props:{apiKey:Object},setup(){return{store:$()}},data(){return{confirmDelete:!1}},methods:{deleteAPIKey(){w("/api/deleteDashboardAPIKey",{Key:this.apiKey.Key},t=>{t.status?(this.$emit("deleted",t.data),this.store.newMessage("Server","API Key deleted","success")):this.store.newMessage("Server",t.message,"danger")})}}},Te={class:"card rounded-3 shadow-sm"},Ve={key:0,class:"card-body d-flex gap-3 align-items-center apiKey-card-body"},Ee={class:"d-flex align-items-center gap-2"},Le={class:"text-muted"},Fe={style:{"word-break":"break-all"}},Me={class:"d-flex align-items-center gap-2 ms-auto"},Ne={class:"text-muted"},Ue={key:0,class:"card-body d-flex gap-3 align-items-center justify-content-end"};function Ye(t,s,b,f,u,p){const o=y("LocaleText");return i(),r("div",Te,[this.confirmDelete?(i(),r(K,{key:1},[this.store.getActiveCrossServer()?g("",!0):(i(),r("div",Ue,[l(o,{t:"Are you sure to delete this API key?"}),e("a",{role:"button",class:"btn btn-sm bg-success-subtle text-success-emphasis rounded-3",onClick:s[1]||(s[1]=a=>this.deleteAPIKey())},[...s[4]||(s[4]=[e("i",{class:"bi bi-check-lg"},null,-1)])]),e("a",{role:"button",class:"btn btn-sm bg-secondary-subtle text-secondary-emphasis rounded-3",onClick:s[2]||(s[2]=a=>this.confirmDelete=!1)},[...s[5]||(s[5]=[e("i",{class:"bi bi-x-lg"},null,-1)])])]))],64)):(i(),r("div",Ve,[e("div",Ee,[e("small",Le,[l(o,{t:"Key"})]),e("span",Fe,x(this.apiKey.Key),1)]),e("div",Me,[e("small",Ne,[l(o,{t:"Expire At"})]),this.apiKey.ExpiredAt?g("",!0):(i(),_(o,{key:0,t:"Never Expire"})),e("span",null,x(this.apiKey.ExpiredAt),1)]),this.store.getActiveCrossServer()?g("",!0):(i(),r("a",{key:0,role:"button",class:"btn btn-sm bg-danger-subtle text-danger-emphasis rounded-3",onClick:s[0]||(s[0]=a=>this.confirmDelete=!0)},[...s[3]||(s[3]=[e("i",{class:"bi bi-trash-fill"},null,-1)])]))]))])}const He=A(Ke,[["render",Ye],["__scopeId","data-v-a76253c8"]]),Re={name:"dashboardAPIKeys",components:{LocaleText:c,DashboardAPIKey:He,NewDashboardAPIKey:Se},setup(){return{store:$()}},data(){return{value:this.store.Configuration.Server.dashboard_api_key,apiKeys:[],newDashboardAPIKey:!1}},methods:{async toggleDashboardAPIKeys(){await w("/api/updateDashboardConfigurationItem",{section:"Server",key:"dashboard_api_key",value:this.value},t=>{t.status?(this.store.Configuration.Peers[this.targetData]=this.value,this.store.newMessage("Server",`API Keys function is successfully ${this.value?"enabled":"disabled"}`,"success")):(this.value=this.store.Configuration.Peers[this.targetData],this.store.newMessage("Server",`API Keys function is failed to ${this.value?"enabled":"disabled"}`,"danger"))})}},watch:{value:{immediate:!0,handler(t){t?T("/api/getDashboardAPIKeys",{},s=>{s.status?this.apiKeys=s.data:(this.apiKeys=[],this.store.newMessage("Server",s.message,"danger"))}):this.apiKeys=[]}}}},qe={class:"card rounded-3"},Be={class:"my-2"},je={key:0,class:"form-check form-switch ms-auto"},ze={class:"form-check-label",for:"allowAPIKeysSwitch"},We={key:0,class:"card-body position-relative d-flex flex-column gap-2"},Ge={key:1,class:"card",style:{height:"300px"}},Oe={class:"card-body d-flex text-muted"},Ze={class:"m-auto"},Je={key:2,class:"d-flex flex-column gap-2 position-relative",style:{"min-height":"300px"}};function Qe(t,s,b,f,u,p){const o=y("LocaleText"),a=y("DashboardAPIKey"),n=y("NewDashboardAPIKey");return i(),r("div",qe,[e("div",{class:k(["card-header d-flex align-items-center",{"border-bottom-0 rounded-3":!this.value}])},[e("h6",Be,[s[6]||(s[6]=e("i",{class:"bi bi-key-fill me-2"},null,-1)),l(o,{t:"API Keys"})]),this.store.getActiveCrossServer()?g("",!0):(i(),r("div",je,[h(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=d=>this.value=d),onChange:s[1]||(s[1]=d=>this.toggleDashboardAPIKeys()),role:"switch",id:"allowAPIKeysSwitch"},null,544),[[D,this.value]]),e("label",ze,[this.value?(i(),_(o,{key:0,t:"Enabled"})):(i(),_(o,{key:1,t:"Disabled"}))])]))],2),this.value?(i(),r("div",We,[this.store.getActiveCrossServer()?g("",!0):(i(),r("button",{key:0,class:"btn bg-primary-subtle text-primary-emphasis border-1 border-primary-subtle rounded-3 shadow-sm",onClick:s[2]||(s[2]=d=>this.newDashboardAPIKey=!0)},[s[7]||(s[7]=e("i",{class:"bi bi-plus-circle-fill me-2"},null,-1)),l(o,{t:"API Key"})])),this.apiKeys.length===0?(i(),r("div",Ge,[e("div",Oe,[e("span",Ze,[l(o,{t:"No WGDashboard API Key"})])])])):(i(),r("div",Je,[l(N,{name:"apiKey"},{default:V(()=>[(i(!0),r(K,null,E(this.apiKeys,d=>(i(),_(a,{apiKey:d,key:d.Key,onDeleted:s[3]||(s[3]=L=>this.apiKeys=L)},null,8,["apiKey"]))),128))]),_:1})])),l(U,{name:"zoomReversed"},{default:V(()=>[this.newDashboardAPIKey?(i(),_(n,{key:0,onCreated:s[4]||(s[4]=d=>this.apiKeys=d),onClose:s[5]||(s[5]=d=>this.newDashboardAPIKey=!1)})):g("",!0)]),_:1})])):g("",!0)])}const wt=A(Re,[["render",Qe],["__scopeId","data-v-f7e62927"]]),Xe={name:"accountSettingsMFA",components:{LocaleText:c},setup(){const t=$(),s=`input_${S()}`;return{store:t,uuid:s}},data(){return{status:!1}},mounted(){this.status=this.store.Configuration.Account.enable_totp},methods:{async resetMFA(){await w("/api/updateDashboardConfigurationItem",{section:"Account",key:"totp_verified",value:"false"},async t=>{await w("/api/updateDashboardConfigurationItem",{section:"Account",key:"enable_totp",value:"false"},s=>{s.status&&this.$router.push("/2FASetup")})})}}},es={class:"d-flex align-items-center"},ss={class:"form-check form-switch"},ts={for:"allowMFAKeysSwitch"};function as(t,s,b,f,u,p){const o=y("LocaleText");return i(),r("div",null,[e("div",es,[e("div",ss,[h(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=a=>this.status=a),role:"switch",id:"allowMFAKeysSwitch"},null,512),[[D,this.status]]),e("label",ts,[this.status?(i(),_(o,{key:0,t:"Enabled"})):(i(),_(o,{key:1,t:"Disabled"}))])]),this.status?(i(),r("button",{key:0,class:"btn bg-warning-subtle text-warning-emphasis border-1 border-warning-subtle ms-auto rounded-3 shadow-sm",onClick:s[1]||(s[1]=a=>this.resetMFA())},[s[2]||(s[2]=e("i",{class:"bi bi-shield-lock-fill me-2"},null,-1)),this.store.Configuration.Account.totp_verified?(i(),_(o,{key:0,t:"Reset"})):(i(),_(o,{key:1,t:"Setup"})),s[3]||(s[3]=P(" MFA ",-1))])):g("",!0)])])}const kt=A(Xe,[["render",as]]),is={name:"dashboardLanguage",components:{LocaleText:c},setup(){return{store:$()}},data(){return{languages:void 0}},mounted(){T("/api/locale/available",{},t=>{this.languages=t.data})},methods:{changeLanguage(t){w("/api/locale/update",{lang_id:t},s=>{s.status?(this.store.Configuration.Server.dashboard_language=t,this.store.Locale=s.data):this.store.newMessage("Server","WGDashboard language update failed","danger")})}},computed:{currentLanguage(){let t=this.store.Configuration.Server.dashboard_language;return this.languages.find(s=>s.lang_id===t)}}},os={class:"text-muted d-block mb-1"},ns={class:"d-flex gap-2"},ls={class:"dropdown w-100"},ds=["disabled"],rs={key:1},us={class:"dropdown-menu rounded-3 shadow",style:{"max-height":"500px","overflow-y":"scroll"}},cs=["onClick"],ms={class:"me-auto mb-0"},hs={class:"d-block",style:{"font-size":"0.8rem"}},ps={key:0,class:"bi bi-check text-primary fs-5"};function bs(t,s,b,f,u,p){const o=y("LocaleText");return i(),r("div",null,[e("small",os,[e("strong",null,[l(o,{t:"Language"})])]),e("div",ns,[e("div",ls,[e("button",{class:"btn bg-primary-subtle text-primary-emphasis dropdown-toggle w-100 rounded-3",disabled:!this.languages,type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[this.languages?(i(),r("span",rs,x(p.currentLanguage?.lang_name_localized),1)):(i(),_(o,{key:0,t:"Loading..."}))],8,ds),e("ul",us,[(i(!0),r(K,null,E(this.languages,a=>(i(),r("li",null,[e("a",{class:"dropdown-item d-flex align-items-center",role:"button",onClick:n=>this.changeLanguage(a.lang_id)},[e("p",ms,[P(x(a.lang_name_localized)+" ",1),e("small",hs,x(a.lang_name),1)]),p.currentLanguage?.lang_id===a.lang_id?(i(),r("i",ps)):g("",!0)],8,cs)]))),256))])])])])}const $t=A(is,[["render",bs],["__scopeId","data-v-4e34593e"]]),fs={name:"dashboardIPPortInput",components:{LocaleText:c},setup(){return{store:$()}},data(){return{ipAddress:"",port:0,invalidFeedback:"",showInvalidFeedback:!1,isValid:!1,timeout:void 0,changed:!1,updating:!1}},mounted(){this.ipAddress=this.store.Configuration.Server.app_ip,this.port=this.store.Configuration.Server.app_port},methods:{async useValidation(t,s,b){this.changed&&(this.updating=!0,await w("/api/updateDashboardConfigurationItem",{section:"Server",key:s,value:b},f=>{f.status?(t.target.classList.add("is-valid"),this.showInvalidFeedback=!1,this.store.Configuration.Server[s]=b,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{t.target.classList.remove("is-valid")},5e3)):(this.isValid=!1,this.showInvalidFeedback=!0,this.invalidFeedback=f.message),this.changed=!1,this.updating=!1}))}}},gs={class:"row g-2"},vs={class:"col-sm"},_s={class:"form-group"},ys={for:"input_dashboard_ip",class:"text-muted mb-1"},ws=["disabled"],ks={class:"invalid-feedback"},$s={class:"col-sm"},xs={class:"form-group"},As={for:"input_dashboard_ip",class:"text-muted mb-1"},Cs=["disabled"],Ps={class:"invalid-feedback"},Ds={class:"px-2 py-1 text-warning-emphasis bg-warning-subtle border border-warning-subtle rounded-2 d-inline-block mb-2 mt-2"};function Is(t,s,b,f,u,p){const o=y("LocaleText");return i(),r("div",null,[e("div",gs,[e("div",vs,[e("div",_s,[e("label",ys,[e("strong",null,[e("small",null,[l(o,{t:"IP Address / Hostname"})])])]),h(e("input",{type:"text",class:k(["form-control",{"is-invalid":u.showInvalidFeedback,"is-valid":u.isValid}]),id:"input_dashboard_ip","onUpdate:modelValue":s[0]||(s[0]=a=>this.ipAddress=a),onKeydown:s[1]||(s[1]=a=>this.changed=!0),onBlur:s[2]||(s[2]=a=>p.useValidation(a,"app_ip",this.ipAddress)),disabled:this.updating},null,42,ws),[[v,this.ipAddress]]),e("div",ks,x(this.invalidFeedback),1)])]),e("div",$s,[e("div",xs,[e("label",As,[e("strong",null,[e("small",null,[l(o,{t:"Listen Port"})])])]),h(e("input",{type:"number",class:k(["form-control",{"is-invalid":u.showInvalidFeedback,"is-valid":u.isValid}]),id:"input_dashboard_ip","onUpdate:modelValue":s[3]||(s[3]=a=>this.port=a),onKeydown:s[4]||(s[4]=a=>this.changed=!0),onBlur:s[5]||(s[5]=a=>p.useValidation(a,"app_port",this.port)),disabled:this.updating},null,42,Cs),[[v,this.port]]),e("div",Ps,x(this.invalidFeedback),1)])])]),e("div",Ds,[e("small",null,[s[6]||(s[6]=e("i",{class:"bi bi-exclamation-triangle-fill me-2"},null,-1)),l(o,{t:"Manual restart of WGDashboard is needed to apply changes on IP Address and Listen Port"})])])])}const xt=A(fs,[["render",Is]]),Ss={class:"card"},Ks={class:"card-header"},Ts={class:"my-2 d-flex"},Vs={key:0,class:"text-success ms-auto"},Es={class:"card-body d-flex flex-column gap-3"},Ls={class:"row gx-2 gy-2"},Fs={class:"col-12"},Ms={class:"form-check mb-2 form-switch"},Ns={class:"form-check-label",for:"authentication_required"},Us={class:"col-12 col-lg-4"},Ys={class:"form-group"},Hs={for:"server",class:"text-muted mb-1"},Rs={class:"col-12 col-lg-4"},qs={class:"form-group"},Bs={for:"port",class:"text-muted mb-1"},js={class:"col-12 col-lg-4"},zs={class:"form-group"},Ws={for:"encryption",class:"text-muted mb-1"},Gs={value:"NOTLS"},Os={key:0,class:"col-12 col-lg-4"},Zs={class:"form-group"},Js={for:"username",class:"text-muted mb-1"},Qs={key:1,class:"col-12 col-lg-4"},Xs={class:"form-group"},et={for:"email_password",class:"text-muted mb-1"},st={class:"col-12 col-lg-4"},tt={class:"form-group"},at={for:"send_from",class:"text-muted mb-1"},it={key:0},ot={key:1},nt={class:"text-muted mb-1",for:"test_email"},lt={class:"fw-bold"},dt=["disabled"],rt=["disabled"],ut={key:0,class:"bi bi-send me-2"},ct={key:1,class:"spinner-border spinner-border-sm me-2"},mt={class:"text-muted mb-1",for:"email_template"},ht={class:"fw-bold"},At={__name:"dashboardEmailSettings",setup(t){const s=$();Y(()=>{p(),document.querySelectorAll("#emailAccount input, #emailAccount select, #email_template").forEach(a=>{a.addEventListener("change",async()=>{let n=a.attributes.getNamedItem("id").value;await w("/api/updateDashboardConfigurationItem",{section:"Email",key:n,value:s.Configuration.Email[n]},d=>{d.status?(a.classList.remove("is-invalid"),a.classList.add("is-valid")):(a.classList.remove("is-valid"),a.classList.add("is-invalid")),p()})})})});const b=I(!1),f=I(""),u=I(!1),p=async()=>{await T("/api/email/ready",{},a=>{b.value=a.status})},o=async()=>{u.value=!0,await w("/api/email/send",{Receiver:f.value,Subject:"WGDashboard Testing Email",Body:"Test 1, 2, 3! Hello World :)"},a=>{a.status?s.newMessage("Server","Test email sent successfully!","success"):s.newMessage("Server",`Test email sent failed! Reason: ${a.message}`,"danger"),u.value=!1})};return(a,n)=>(i(),r("div",Ss,[e("div",Ks,[e("h6",Ts,[n[12]||(n[12]=e("i",{class:"bi bi-envelope-fill me-2"},null,-1)),l(c,{t:"Email Account"}),b.value?(i(),r("span",Vs,[n[11]||(n[11]=e("i",{class:"bi bi-check-circle-fill me-2"},null,-1)),l(c,{t:"Ready"})])):g("",!0)])]),e("div",Es,[e("form",{onSubmit:n[7]||(n[7]=d=>d.preventDefault(d)),id:"emailAccount"},[e("div",Ls,[e("div",Fs,[e("div",Ms,[h(e("input",{class:"form-check-input",type:"checkbox",role:"switch","onUpdate:modelValue":n[0]||(n[0]=d=>m(s).Configuration.Email.authentication_required=d),id:"authentication_required"},null,512),[[D,m(s).Configuration.Email.authentication_required]]),e("label",Ns,[l(c,{t:"Require SMTP Authentication"})])])]),e("div",Us,[e("div",Ys,[e("label",Hs,[e("strong",null,[e("small",null,[l(c,{t:"Server"})])])]),h(e("input",{id:"server","onUpdate:modelValue":n[1]||(n[1]=d=>m(s).Configuration.Email.server=d),type:"text",class:"form-control rounded-3"},null,512),[[v,m(s).Configuration.Email.server]])])]),e("div",Rs,[e("div",qs,[e("label",Bs,[e("strong",null,[e("small",null,[l(c,{t:"Port"})])])]),h(e("input",{id:"port","onUpdate:modelValue":n[2]||(n[2]=d=>m(s).Configuration.Email.port=d),type:"text",class:"form-control rounded-3"},null,512),[[v,m(s).Configuration.Email.port]])])]),e("div",js,[e("div",zs,[e("label",Ws,[e("strong",null,[e("small",null,[l(c,{t:"Encryption"})])])]),h(e("select",{class:"form-select rounded-3","onUpdate:modelValue":n[3]||(n[3]=d=>m(s).Configuration.Email.encryption=d),id:"encryption"},[n[13]||(n[13]=e("option",{value:"STARTTLS"}," STARTTLS ",-1)),e("option",Gs,[l(c,{t:"No Encryption"})])],512),[[H,m(s).Configuration.Email.encryption]])])]),m(s).Configuration.Email.authentication_required?(i(),r("div",Os,[e("div",Zs,[e("label",Js,[e("strong",null,[e("small",null,[l(c,{t:"Username"})])])]),h(e("input",{id:"username","onUpdate:modelValue":n[4]||(n[4]=d=>m(s).Configuration.Email.username=d),type:"text",class:"form-control rounded-3"},null,512),[[v,m(s).Configuration.Email.username]])])])):g("",!0),m(s).Configuration.Email.authentication_required?(i(),r("div",Qs,[e("div",Xs,[e("label",et,[e("strong",null,[e("small",null,[l(c,{t:"Password"})])])]),h(e("input",{id:"email_password","onUpdate:modelValue":n[5]||(n[5]=d=>m(s).Configuration.Email.email_password=d),type:"password",class:"form-control rounded-3"},null,512),[[v,m(s).Configuration.Email.email_password]])])])):g("",!0),e("div",st,[e("div",tt,[e("label",at,[e("strong",null,[e("small",null,[l(c,{t:"Send From"})])])]),h(e("input",{id:"send_from","onUpdate:modelValue":n[6]||(n[6]=d=>m(s).Configuration.Email.send_from=d),type:"text",class:"form-control rounded-3"},null,512),[[v,m(s).Configuration.Email.send_from]])])])])],32),b.value?(i(),r("hr",it)):g("",!0),b.value?(i(),r("div",ot,[e("label",nt,[e("small",lt,[l(c,{t:"Send Test Email"})])]),e("form",{onSubmit:n[9]||(n[9]=d=>{d.preventDefault(),o()}),class:"input-group"},[h(e("input",{type:"email",class:"form-control rounded-start-3",id:"test_email",placeholder:"john@example.com","onUpdate:modelValue":n[8]||(n[8]=d=>f.value=d),disabled:u.value},null,8,dt),[[v,f.value]]),e("button",{class:"btn bg-primary-subtle text-primary-emphasis border-primary-subtle rounded-end-3",type:"submit",value:"Submit",disabled:f.value.length===0||u.value,id:"button-addon2"},[u.value?(i(),r("span",ct)):(i(),r("i",ut)),l(c,{t:u.value?"Sending...":"Send"},null,8,["t"])],8,rt)],32)])):g("",!0),n[14]||(n[14]=e("hr",null,null,-1)),e("div",null,[e("label",mt,[e("small",ht,[l(c,{t:"Email Body Template"})])]),h(e("textarea",{class:"form-control rounded-3 font-monospace","onUpdate:modelValue":n[10]||(n[10]=d=>m(s).Configuration.Email.email_template=d),id:"email_template",style:{"min-height":"400px"}},null,512),[[v,m(s).Configuration.Email.email_template]])])])]))}};export{vt as A,yt as D,At as _,_t as a,wt as b,kt as c,$t as d,xt as e};
